<html>
<body style="margin:0px;width:100%;height:100%;background-color:#000">
<div id="u" style="width:50%;height:10%;background-color:#f00;position:absolute;top:5%;left:25%;border-top-left-radius:100px;border-top-right-radius:100px;" ></div>
<div id="d" style="width:50%;height:10%;background-color:#f00;position:absolute;top:85%;left:25%;border-bottom-left-radius:100px;border-bottom-right-radius:100px;" ></div>
<div id="r" style="width:10%;height:50%;background-color:#f00;position:absolute;top:25%;left:85%;border-top-right-radius:100px;border-bottom-right-radius:100px;" ></div>
<div id="l" style="width:10%;height:50%;background-color:#f00;position:absolute;top:25%;left:5%;border-top-left-radius:100px;border-bottom-left-radius:100px;" ></div>
<script type="text/javascript">
    var d = null;
    window.addEventListener('load', function(){
        function btn_start(dir){
            document.getElementById('u').style.background = "#f00";
            document.getElementById('d').style.background = "#f00";
            document.getElementById('l').style.background = "#f00";
            document.getElementById('r').style.background = "#f00";
            
            document.getElementById(dir).style.background = "#0f0";
            d = dir;
            sendDirection();
        }
        function btn_end(dir){
            document.getElementById('u').style.background = "#f00";
            document.getElementById('d').style.background = "#f00";
            document.getElementById('l').style.background = "#f00";
            document.getElementById('r').style.background = "#f00";
            d = "0";
            sendDirection();
        }
        function sendDirection(){
           var xmlHttp = new XMLHttpRequest();
           xmlHttp.open( "POST", location.href, false ); // false for synchronous request
           xmlHttp.send( d );
           console.log('--'+xmlHttp.responseText+'--');
        }
        var dirs = ['u','d','l','r'];
        for(var i=0;i<4;i++){
            (function(dir){
                document.getElementById(dir).addEventListener('mousedown', function(e){
                    btn_start(dir);
                }, false);
                document.getElementById(dir).addEventListener('mouseup', function(e){
                    btn_end(dir);
                }, false);
                document.getElementById(dir).addEventListener('mouseout', function(e){
                    btn_end(dir);
                }, false);
                document.getElementById(dir).addEventListener('touchstart', function(e){
                    btn_start(dir);
                }, false);
                document.getElementById(dir).addEventListener('touchenter', function(e){
                    btn_start(dir);
                }, false);
                document.getElementById(dir).addEventListener('touchend', function(e){
                    btn_end(dir);
                }, false);
                document.getElementById(dir).addEventListener('touchleave', function(e){
                    btn_end(dir);
                }, false);
            })(dirs[i])
        }
    }, false);
</script>
</body>
</html>
